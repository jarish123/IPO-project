<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IPO Tracking - Bluestock</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link href="styles.css" rel="stylesheet" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4">
      <a class="navbar-brand fw-bold" href="ipo_home_page.html">Bluestock</a>
    </nav>

    <div class="container py-5">
      <h3 class="fw-bold mb-4">Track Your IPO</h3>
      <form id="trackingForm" class="mb-4">
        <div class="input-group">
          <input
            type="text"
            class="form-control"
            id="trackingId"
            placeholder="Enter Application Number or PAN"
          />
          <button class="btn btn-primary" type="submit">Track</button>
        </div>
      </form>
      <div id="trackingResult"></div>
    </div>

    <script>
      document
        .getElementById("trackingForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const id = document.getElementById("trackingId").value;
          const resultBox = document.getElementById("trackingResult");

          if (!id) {
            resultBox.innerHTML =
              '<p class="text-danger">Please enter a valid ID.</p>';
            return;
          }

          fetch(fetch(`http://127.0.0.1:8000/api/ipo/${id}/`))
            .then((res) => (res.ok ? res.json() : Promise.reject("Not found")))
            .then((data) => {
              resultBox.innerHTML = `
            <div class="card p-3">
              <h5>Status: <span class="badge bg-info">${data.status}</span></h5>
              <p><strong>Company:</strong> ${data.company_name}</p>
              <p><strong>Allotment Date:</strong> ${data.allotment_date}</p>
              <p><strong>Refund Date:</strong> ${data.refund_date}</p>
            </div>
          `;
            })
            .catch(() => {
              resultBox.innerHTML =
                '<p class="text-danger">No record found for this ID.</p>';
            });
        });
    </script>
  </body>
</html>
